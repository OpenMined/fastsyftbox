<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Syftbox SDK</title>
</head>

<body>
    <h1>Welcome to Syftbox SDK</h1>
    <p>This page demonstrates the integration of the Syftbox SDK.</p>
    <script src="/js/syftbox-sdk.js"></script>
    <script>
        // You can use it right away!
        // syftFetch("syft://madhava@openmined.org/app_data/fastsyftbox/rpc/hello", {
        //     method: "POST",
        //     headers: { "x-syft-from": "you@example.com" },
        //     body: JSON.stringify({ message: "Hello World" })
        // }).then(console.log).catch(console.error);

        // Reconfigure later if needed:
        // syftFetch.serverUrl = "https://another-syftbox.com/";
    </script>
    <button id="test-syft-fetch" class="btn btn-primary">Test Syft Fetch</button>
    <button id="test-parse-url" class="btn btn-secondary">Test Parse Syft URL</button>

    <script>
        document.getElementById('test-syft-fetch').addEventListener('click', async function () {

            try {
                const response = await syftFetch("syft://madhava@openmined.org/app_data/fastsyftbox/rpc/hello", {
                    method: 'POST',
                    headers: {
                        'x-syft-from': 'test@syft.local'
                    },
                    body: JSON.stringify({ message: "Hello, Syft!" })
                });
                console.log('Syft Fetch Response:', response);
                alert('Syft Fetch successful! Check console for details.');
            } catch (error) {
                console.error('Syft Fetch Error:', error);
                alert('Syft Fetch failed! Check console for details.');
            }
        });

        document.getElementById('test-parse-url').addEventListener('click', function () {
            const sdk = new SyftBoxSDK({ serverUrl: "https://syftboxdev.openmined.org/" });
            try {
                const parsedData = sdk.parseSyftUrl("syft://madhava@openmined.org/app_data/fastsyftbox/rpc/hello");
                console.log('Parsed Syft URL:', parsedData);
                alert('Syft URL parsed successfully! Check console for details.');
            } catch (error) {
                console.error('Parse Syft URL Error:', error);
                alert('Parsing Syft URL failed! Check console for details.');
            }
        });
    </script>
</body>

</html>